<% content_for :title, "Modifier la notation - Admin OLAK" %>

<div class="max-w-4xl mx-auto px-4 py-8">
  <!-- Breadcrumb -->
  <nav class="mb-6" aria-label="Breadcrumb">
    <ol class="flex items-center space-x-2 text-sm">
      <li><%= link_to "Admin", admin_root_path, class: "text-gray-500 hover:text-olak-primary transition-colors" %></li>
      <li><span class="text-gray-400">/</span></li>
      <li><%= link_to "Notations", admin_applications_path, class: "text-gray-500 hover:text-olak-primary transition-colors" %></li>
      <li><span class="text-gray-400">/</span></li>
      <li><span class="text-gray-500 hover:text-olak-primary transition-colors">#12345</span></li>
      <li><span class="text-gray-400">/</span></li>
      <li><span class="text-olak-primary font-semibold">Modifier</span></li>
    </ol>
  </nav>

  <!-- Page Title -->
  <div class="flex items-center justify-between mb-8">
    <h1 class="text-4xl font-bold text-olak-primary-dark">Modifier la notation</h1>
    <span class="badge badge-pending">Non proposée</span>
  </div>

  <!-- Warning Alert -->
  <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r-lg mb-6">
    <div class="flex items-center">
      <svg class="w-6 h-6 text-orange-500 mr-3 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
      </svg>
      <div>
        <p class="text-orange-800 font-semibold">Attention</p>
        <p class="text-orange-700 text-sm mt-1">Modifier cette notation nécessitera une nouvelle proposition au propriétaire.</p>
      </div>
    </div>
  </div>

  <!-- Metadata -->
  <div class="card-olak mb-6 bg-olak-gray">
    <div class="flex items-center justify-between text-sm">
      <div>
        <span class="text-gray-600">Créée le:</span>
        <span class="font-semibold text-olak-dark ml-2">15/11/2024</span>
      </div>
      <div>
        <span class="text-gray-600">Par:</span>
        <span class="font-semibold text-olak-dark ml-2">Jean Admin</span>
      </div>
    </div>
  </div>

  <!-- Candidate Info Card -->
  <div class="card-olak mb-6">
    <div class="flex justify-between items-start mb-4">
      <h2 class="text-2xl font-semibold text-olak-dark">Informations du candidat</h2>
      <span class="badge badge-success">Documents validés</span>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <p class="text-sm text-gray-600 mb-1">Nom complet</p>
        <p class="font-semibold text-olak-dark">Marie Dupont</p>
      </div>
      <div>
        <p class="text-sm text-gray-600 mb-1">Email</p>
        <p class="font-semibold text-olak-dark">marie.dupont@example.olak.fr</p>
      </div>
      <div>
        <p class="text-sm text-gray-600 mb-1">Téléphone</p>
        <p class="font-semibold text-olak-dark">06 98 76 54 32</p>
      </div>
      <div>
        <p class="text-sm text-gray-600 mb-1">Statut professionnel</p>
        <p class="font-semibold text-olak-dark">CDI</p>
      </div>
      <div>
        <p class="text-sm text-gray-600 mb-1">Salaire mensuel net</p>
        <p class="font-semibold text-olak-primary">2 800 €</p>
      </div>
      <div>
        <p class="text-sm text-gray-600 mb-1">Type de garantie</p>
        <p class="font-semibold text-olak-dark">Garantie Visale</p>
      </div>
    </div>
  </div>

  <!-- Property Info Card -->
  <div class="card-olak mb-6">
    <h2 class="text-2xl font-semibold text-olak-dark mb-4">Bien concerné</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <p class="text-sm text-gray-600 mb-1">Type de bien</p>
        <p class="font-semibold text-olak-dark">Appartement T3</p>
      </div>
      <div>
        <p class="text-sm text-gray-600 mb-1">Localisation</p>
        <p class="font-semibold text-olak-dark">Paris 15ème</p>
      </div>
      <div>
        <p class="text-sm text-gray-600 mb-1">Adresse</p>
        <p class="font-semibold text-olak-dark">45 Avenue des Champs-Élysées</p>
      </div>
      <div>
        <p class="text-sm text-gray-600 mb-1">Loyer mensuel</p>
        <p class="font-semibold text-olak-primary">1 200 € + 150 € charges</p>
      </div>
    </div>
  </div>

  <!-- Rating Form with Pre-filled Values -->
  <div class="card-olak">
    <h2 class="text-2xl font-semibold text-olak-dark mb-6">Évaluation multidimensionnelle</h2>
    
    <form action="#" method="post" class="space-y-6">
      <!-- Salary/Rent Ratio (pre-filled: 5/5) -->
      <div>
        <label class="block text-sm font-semibold mb-3 text-olak-dark">
          Ratio Salaire/Loyer <span class="text-olak-error">*</span>
        </label>
        <div class="flex items-center gap-1">
          <% 5.times do |i| %>
            <input type="radio" name="salary_ratio" value="<%= i + 1 %>" <%= 'checked' if i == 4 %> class="hidden peer/<%= i + 1 %>" id="salary_<%= i + 1 %>">
            <label for="salary_<%= i + 1 %>" class="cursor-pointer">
              <svg class="w-8 h-8 <%= i < 5 ? 'text-yellow-400' : 'text-gray-300' %> hover:text-yellow-400 peer-checked/<%=i+1%>:text-yellow-400 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
              </svg>
            </label>
          <% end %>
        </div>
      </div>

      <!-- Contract Type (pre-filled: 5/5) -->
      <div>
        <label class="block text-sm font-semibold mb-3 text-olak-dark">
          Type de contrat <span class="text-olak-error">*</span>
        </label>
        <div class="flex items-center gap-1">
          <% 5.times do |i| %>
            <input type="radio" name="contract_type" value="<%= i + 1 %>" <%= 'checked' if i == 4 %> class="hidden peer/c<%= i + 1 %>" id="contract_<%= i + 1 %>">
            <label for="contract_<%= i + 1 %>" class="cursor-pointer">
              <svg class="w-8 h-8 <%= i < 5 ? 'text-yellow-400' : 'text-gray-300' %> hover:text-yellow-400 peer-checked/c<%=i+1%>:text-yellow-400 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
              </svg>
            </label>
          <% end %>
        </div>
      </div>

      <!-- Guarantors (pre-filled: 4/5) -->
      <div>
        <label class="block text-sm font-semibold mb-3 text-olak-dark">
          Garanties <span class="text-olak-error">*</span>
        </label>
        <div class="flex items-center gap-1">
          <% 5.times do |i| %>
            <input type="radio" name="guarantors" value="<%= i + 1 %>" <%= 'checked' if i == 3 %> class="hidden peer/g<%= i + 1 %>" id="guarantor_<%= i + 1 %>">
            <label for="guarantor_<%= i + 1 %>" class="cursor-pointer">
              <svg class="w-8 h-8 <%= i < 4 ? 'text-yellow-400' : 'text-gray-300' %> hover:text-yellow-400 peer-checked/g<%=i+1%>:text-yellow-400 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
              </svg>
            </label>
          <% end %>
        </div>
      </div>

      <!-- Contract Duration (pre-filled: 4/5) -->
      <div>
        <label class="block text-sm font-semibold mb-3 text-olak-dark">
          Durée de location souhaitée <span class="text-olak-error">*</span>
        </label>
        <div class="flex items-center gap-1">
          <% 5.times do |i| %>
            <input type="radio" name="duration" value="<%= i + 1 %>" <%= 'checked' if i == 3 %> class="hidden peer/d<%= i + 1 %>" id="duration_<%= i + 1 %>">
            <label for="duration_<%= i + 1 %>" class="cursor-pointer">
              <svg class="w-8 h-8 <%= i < 4 ? 'text-yellow-400' : 'text-gray-300' %> hover:text-yellow-400 peer-checked/d<%=i+1%>:text-yellow-400 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
              </svg>
            </label>
          <% end %>
        </div>
      </div>

      <!-- Agent Feeling (pre-filled: 4/5) -->
      <div>
        <label class="block text-sm font-semibold mb-3 text-olak-dark">
          Ressenti de l'agent <span class="text-olak-error">*</span>
        </label>
        <div class="flex items-center gap-1">
          <% 5.times do |i| %>
            <input type="radio" name="agent_feeling" value="<%= i + 1 %>" <%= 'checked' if i == 3 %> class="hidden peer/a<%= i + 1 %>" id="feeling_<%= i + 1 %>">
            <label for="feeling_<%= i + 1 %>" class="cursor-pointer">
              <svg class="w-8 h-8 <%= i < 4 ? 'text-yellow-400' : 'text-gray-300' %> hover:text-yellow-400 peer-checked/a<%=i+1%>:text-yellow-400 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
              </svg>
            </label>
          <% end %>
        </div>
      </div>

      <!-- Overall Score Display -->
      <div class="border-t pt-6 mt-6">
        <div class="bg-olak-gray p-4 rounded-lg">
          <div class="flex items-center justify-between">
            <span class="text-lg font-bold text-olak-dark">Note globale</span>
            <span class="text-3xl font-bold text-olak-primary">4.4/5</span>
          </div>
        </div>
      </div>

      <!-- Notes (pre-filled) -->
      <div>
        <label class="block text-sm font-semibold mb-2 text-olak-dark">
          Notes et commentaires
        </label>
        <textarea class="input-olak" rows="4">Excellent candidat, profil très solide avec CDI et garantie Visale. Motivé pour une location longue durée.</textarea>
      </div>

      <!-- Actions -->
      <div class="flex gap-3 pt-4">
        <%= link_to "Annuler", admin_rating_path(id: 1), class: "btn-secondary flex-1 text-center" %>
        <button type="submit" class="btn-primary flex-1">
          Enregistrer les modifications
        </button>
      </div>
    </form>
  </div>
</div>
